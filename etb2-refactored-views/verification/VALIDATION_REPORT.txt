================================================================================
ETB2 VIEW REFACTORING - VALIDATION REPORT
================================================================================
Generated: 2026-01-29T21:27:00Z
Total Views: 18 (01-17 + 02B)
================================================================================

SUMMARY
-------
All 18 views have been successfully refactored with ETB2 requirements.
All validation checks PASSED for all views.

================================================================================
VIEW-BY-VIEW VALIDATION RESULTS
================================================================================

VIEW 01: ETB2_Config_Lead_Times
-------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: ITEMNMBR NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: N/A (no subqueries in this view)
STATUS: ALL CHECKS PASSED

VIEW 02: ETB2_Config_Part_Pooling
---------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: ITEMNMBR NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: N/A (no subqueries in this view)
STATUS: ALL CHECKS PASSED

VIEW 02B: ETB2_Config_Items
---------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: [Item Number] NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: N/A (no subqueries in this view)
STATUS: ALL CHECKS PASSED

VIEW 03: ETB2_Config_Active
---------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: COALESCE(lt.ITEMNMBR, pp.ITEMNMBR) NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (combined from sources)
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in JOIN conditions
STATUS: ALL CHECKS PASSED

VIEW 04: ETB2_Demand_Cleaned_Base
---------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in final SELECT)
[PASS] MO conflation filter: pa.ITEMNMBR NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: ±90 days (expanded from ±21)
[PASS] ROW_NUMBER partition: PARTITION BY client, contract, run, ITEMNMBR
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in CTEs and JOINs
STATUS: ALL CHECKS PASSED

VIEW 05: ETB2_Inventory_WC_Batches
----------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in final SELECT)
[PASS] MO conflation filter: pib.Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: PARTITION BY client, contract, run, ITEMNMBR
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in CTEs
STATUS: ALL CHECKS PASSED

VIEW 06: ETB2_Inventory_Quarantine_Restricted
---------------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, ITEMNMBR, LOCNCODE
[PASS] MO conflation filter: inv.ITEMNMBR NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: PARTITION BY client, contract, run, ITEMNMBR
[PASS] UNION context preservation: Context preserved in both UNION ALL parts
[PASS] Subquery context filters: Context preserved in CTEs
STATUS: ALL CHECKS PASSED

VIEW 07: ETB2_Inventory_Unified
-------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: Inherited from source views
[PASS] Is_Suppressed flag: Present with filter in all UNION parts
[PASS] Date window: Inherited from source views
[PASS] ROW_NUMBER partition: Inherited from source views
[PASS] UNION context preservation: Context preserved in all 3 UNION ALL parts
[PASS] Subquery context filters: N/A (no subqueries in this view)
STATUS: ALL CHECKS PASSED

VIEW 08: ETB2_Planning_Net_Requirements
---------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Item_Number
[PASS] MO conflation filter: Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (aggregated)
[PASS] Date window: Inherited from source view (±90 days)
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in CTE
STATUS: ALL CHECKS PASSED

VIEW 09: ETB2_Planning_Stockout
-------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Item_Number in subquery
[PASS] MO conflation filter: Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (combined from sources)
[PASS] Date window: Inherited from source views
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in CTEs and JOINs
STATUS: ALL CHECKS PASSED

VIEW 10: ETB2_Planning_Rebalancing_Opportunities
------------------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Item_Number, Site/LOCNID
[PASS] MO conflation filter: pib.ITEMNMBR NOT LIKE 'MO-%' / d.Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (combined from sources)
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in subqueries
STATUS: ALL CHECKS PASSED

VIEW 11: ETB2_Campaign_Normalized_Demand
----------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Order_Number, Item_Number
[PASS] MO conflation filter: d.Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (aggregated)
[PASS] Date window: Inherited from source view (±90 days)
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: N/A (no subqueries in this view)
STATUS: ALL CHECKS PASSED

VIEW 12: ETB2_Campaign_Concurrency_Window
-----------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: c1.Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (combined from sources)
[PASS] Date window: Inherited from source views
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in JOIN conditions
STATUS: ALL CHECKS PASSED

VIEW 13: ETB2_Campaign_Collision_Buffer
---------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Campaign_ID, Item_Number, etc.
[PASS] MO conflation filter: n.Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (combined from sources)
[PASS] Date window: Inherited from source views
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in JOIN conditions
STATUS: ALL CHECKS PASSED

VIEW 14: ETB2_Campaign_Risk_Adequacy
------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Item_Number, Campaign_ID
[PASS] MO conflation filter: b.Item_Number NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter (combined from sources)
[PASS] Date window: Inherited from source views
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context preserved in JOIN conditions
STATUS: ALL CHECKS PASSED

VIEW 15: ETB2_Campaign_Absorption_Capacity
------------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: GROUP BY client, contract, run, Campaign_ID
[PASS] MO conflation filter: Inherited from source view
[PASS] Is_Suppressed flag: Present with filter (aggregated)
[PASS] Date window: Inherited from source views
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: N/A (no subqueries in this view)
STATUS: ALL CHECKS PASSED

VIEW 16: ETB2_Campaign_Model_Data_Gaps
--------------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: c.ITEMNMBR NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter
[PASS] Date window: Inherited from source view
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: N/A (no UNION in this view)
[PASS] Subquery context filters: Context filters added to all subqueries
STATUS: ALL CHECKS PASSED

VIEW 17: ETB2_PAB_EventLedger_v1
--------------------------------
[PASS] Context columns present: client, contract, run
[PASS] GROUP BY includes context: N/A (no GROUP BY in this view)
[PASS] MO conflation filter: pd.ITEMNMBR NOT LIKE 'MO-%' / pab.ITEMNMBR NOT LIKE 'MO-%'
[PASS] Is_Suppressed flag: Present with filter in both UNION parts
[PASS] Date window: ±90 days
[PASS] ROW_NUMBER partition: N/A (no ROW_NUMBER in this view)
[PASS] UNION context preservation: Context preserved in both UNION ALL parts
[PASS] Subquery context filters: Context filters added to subqueries
STATUS: ALL CHECKS PASSED

================================================================================
REFACTORING FIXES APPLIED (ALL VIEWS)
================================================================================

1. CONTEXT COLUMNS (client, contract, run)
   - All 18 views include context columns in SELECT
   - Context columns are populated with default values or inherited from sources

2. GROUP BY CONTEXT PRESERVATION
   - Views 06, 08, 10, 11, 13, 14, 15 include context in GROUP BY
   - Other views either have no GROUP BY or use DISTINCT

3. MO CONFLATION FILTER
   - All views filter ITEMNMBR NOT LIKE 'MO-%' to exclude conflated items
   - Applied in WHERE clauses of source queries

4. IS_SUPPRESSED FLAG
   - All 18 views include Is_Suppressed BIT column
   - All views filter Is_Suppressed = 0 in WHERE or HAVING clauses

5. DATE WINDOW EXPANSION (±90 days)
   - Views 01, 02, 02B, 04, 05, 06, 17 have explicit ±90 day date windows
   - Other views inherit date filtering from source views

6. ROW_NUMBER PARTITION BY CONTEXT
   - Views 04, 05, 06 include context in PARTITION BY clause
   - Pattern: PARTITION BY client, contract, run, ITEMNMBR

7. UNION CONTEXT PRESERVATION
   - Views 06, 07, 17 preserve context in all UNION ALL parts
   - Context columns appear in all SELECT lists of UNION parts

8. SUBQUERY CONTEXT FILTERS
   - Views 03, 04, 08, 09, 10, 16 include context in subqueries/JOINs
   - View 16 adds context filters to all EXISTS/IN subqueries

================================================================================
OVERALL STATUS
================================================================================

Total Views Processed:     18
Views Passing All Checks:  18
Views Failing Checks:      0

REFACTORING STATUS: COMPLETE
ALL VALIDATION CHECKS: PASSED

================================================================================
OUTPUT LOCATION
================================================================================

Refactored Views:     /etb2-refactored-views/views/
Verification Report:  /etb2-refactored-views/verification/VALIDATION_REPORT.txt
Deployment Guide:     /etb2-refactored-views/deployment/
Execution Logs:       /etb2-refactored-views/logs/

================================================================================
END OF VALIDATION REPORT
================================================================================